function guid(){function n(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}angular.module("ngFlowchart",[]).provider("ngFlowchartService",[function(){this.options={defaultNewTop:60,defaultNewLeft:60};this.setOptions=function(n){return this.options=n,this};this.setCanUserEditLinks=function(n){return this.options.canUserEditLinks=n,this};this.setCanUserMoveOperators=function(n){return this.options.canUserMoveOperators=n,this};this.setData=function(n){return this.options.data=n,this};this.setDistanceFromArrows=function(n){return this.options.distanceFromArrows=n,this};this.setDefaultLinkColor=function(n){return this.options.defaultLinkColor=n,this};this.setDefaultSelectedLinkColor=function(n){return this.options.defaultSelectedLinkColor=n,this};this.setDefaultOperatorClass=function(n){return this.options.defaultOperatorClass=n,this};this.setLinkWidth=function(n){return this.options.linkWidth=n,this};this.setGridSize=function(n){return this.options.grid=n,this};this.setMultipleLinksOnInput=function(n){return this.options.multipleLinksOnInput=n,this};this.setMultipleLinksOnOutput=function(n){return this.options.multipleLinksOnOutput=n,this};this.setLinkVerticalDecal=function(n){return this.options.linkVerticalDecal=n,this};this.setDefaultNewTop=function(n){return this.options.defaultNewTop=n,this};this.setDefaultNewLeft=function(n){return this.options.defaultNewLeft=n,this};var i=!1,n=[.5,.075,1,1.5,2],t=2;this.setAllowPanZoom=function(n){return i=n,this};this.setZoomLevels=function(t){return n=t,this};this.setInitialZoom=function(n){return t=n,this};this.$get=["$rootScope",function(r){var h=this,s=h.options,u=undefined,e=undefined,f={},o;return f.setFlowchartReference=function(n){u=n;e=u.parent()},f.getFlowchartReference=function(){return u},f.getOptions=function(){return s},f.getConfigurationOptions=function(){return{allowPanZoom:i,zoomLevels:n,initialZoom:t}},o=t,f.enablePanZoom=function(){if(u!==undefined){e===undefined&&(e=u.parent());u.panzoom();var t=u.width()/2,i=u.height()/2;u.panzoom("pan",-t+e.width()/2,-i+e.height()/2);e.on("mousewheel.focal",function(t){t.preventDefault();var i=t.delta||t.originalEvent.wheelData||t.originalEvent.detail,f=i?i<0:t.originalEvent.deltaY>0;o=Math.max(0,Math.min(n.length-1,o+(!f*2-1)));u.flowchart("setPositionRatio",n[o]);u.panzoom("zoom",n[o],{animate:!1,focal:t});r.$broadcast("zoomChanged",{currentZoom:n[o]})})}},f.createOperator=function(n,t,i,r){if(t!==undefined){i===undefined&&(i=s.defaultNewTop);r===undefined&&(r=s.defaultNewLeft);var f={top:i,left:r,properties:t};u.flowchart("createOperator",n,f)}},f.addOperator=function(n,t,i){if(n!==undefined){t===undefined&&(t=s.defaultNewTop);i===undefined&&(i=s.defaultNewLeft);var r={top:t,left:i,properties:n};u.flowchart("createOperator",n.id,r)}},f.deleteOperator=function(n){u.flowchart("deleteOperator",n)},f.selectOperator=function(n){u.flowchart("selectOperator",n)},f.addClassToOperator=function(n,t){u.flowchart("addClassOperator",n,t)},f.removeClassFromOperator=function(n,t){u.flowchart("removeClassOperator",n,t)},f.removeClassFromOperators=function(n){u.flowchart("removeClassOperators",n)},f.getOperatorTitle=function(n){return u.flowchart("getOperatorTitle",n)},f.setOperatorTitle=function(n,t){u.flowchart("setOperatorTitle",n,t)},f.doesOperatorExist=function(n){return u.flowchart("doesOperatorExists",n)},f.getOperatorData=function(n){return u.flowchart("getOperatorData",n)},f.getConnectorPosition=function(n,t){return u.flowchart("getConnectorPosition",n,t)},f.getOperatorElement=function(n){return u.flowchart("getOperatorElement",n)},f.getSelectedOperatorId=function(){return u.flowchart("getSelectedOperatorId")},f.deleteSelected=function(){u.flowchart("deleteSelected")},f.unselectOperator=function(){u.flowchart("unselectOperator")},f.deleteLink=function(n){u.flowchart("deleteLink",n)},f.selectLink=function(n){u.flowchart("selectLink",n)},f.setLinkMainColor=function(n,t){u.flowchart("setLinkMainColor",n,t)},f.getLinkMainColor=function(n){u.flowchart("getLinkMainColor",n)},f.colorizeLink=function(n,t){u.flowchart("colorizeLink",n,t)},f.uncolorizeLink=function(n){u.flowchart("uncolorizeLink",n)},f.redrawLinksLayer=function(){u.flowchart("redrawLinksLayer")},f.getSelectedLinkId=function(){return u.flowchart("getSelectedLinkId")},f.unselectLink=function(){return u.flowchart("unselectLink")},f.getData=function(){return u.flowchart("getData")},f.setData=function(n){u.flowchart("setData",n)},f.setPositionRatio=function(n){u.flowchart("setPositionRatio",n)},f.getPositionRatio=function(){u.flowchart("getPositionRatio")},f.deleteSelected=function(){u.flowchart("deleteSelected")},f}]}]).factory("ngFlowchartOperatorFactory",[function(){var n={},t=function(){var n=this;n.id=guid();n.title="";n.inputs={};n.outputs={};var t=[],r=function(){for(var i={},n=0;n<t.length;n++)i["input_"+n+1]=t[n];return i},i=[],u=function(){for(var t={},n=0;n<i.length;n++)t["output_"+n+1]=i[n];return t};return n.addInput=function(i){t.push(i);n.inputs=r()},n.addOutput=function(t){i.push(t);n.outputs=u()},n};return n.getNew=function(){return t()},n}]).directive("ngFlowchart",["ngFlowchartService",function(n){return{restrict:"E",scope:{onOperatorSelect:"=?",onOperatorUnselect:"=?",onOperatorMouseOver:"=?",onLinkSelect:"=?",onLinkUnselect:"=?",onOperatorCreate:"=?",onOperatorDelete:"=?",onLinkCreate:"=?",onLinkDelete:"=?",onOperatorMoved:"=?",onAfterChanged:"=?"},transclude:!1,replace:!0,template:'<div class="ng-flowchart"><\/div>',link:function(t,i){t.onOperatorSelect===undefined&&(t.onOperatorSelect=function(){return!0});t.onOperatorUnselect===undefined&&(t.onOperatorUnselect=function(){return!0});t.onOperatorMouseOver===undefined&&(t.onOperatorMouseOver=function(){return!0});t.onLinkSelect===undefined&&(t.onLinkSelect=function(){return!0});t.onLinkUnselect===undefined&&(t.onLinkUnselect=function(){return!0});t.onOperatorCreate===undefined&&(t.onOperatorCreate=function(){return!0});t.onOperatorDelete===undefined&&(t.onOperatorDelete=function(){return!0});t.onLinkCreate===undefined&&(t.onLinkCreate=function(){return!0});t.onLinkDelete===undefined&&(t.onLinkDelete=function(){return!0});t.onOperatorMoved===undefined&&(t.onOperatorMoved=function(){});t.onAfterChanged===undefined&&(t.onAfterChanged=function(){});$(i).flowchart({data:n.getOptions().data,onOperatorSelect:t.onOperatorSelect,onOperatorUnselect:t.onOperatorUnselect,onOperatorMouseOver:t.onOperatorMouseOver,onLinkSelect:t.onLinkSelect,onLinkUnselect:t.onLinkUnselect,onOperatorCreate:t.onOperatorCreate,onOperatorDelete:t.onOperatorDelete,onLinkCreate:t.onLinkCreate,onLinkDelete:t.onLinkDelete,onOperatorMoved:t.onOperatorMoved,onAfterChanged:t.onAfterChanged});n.setFlowchartReference($(i));n.getConfigurationOptions().allowPanZoom&&n.enablePanZoom()},controller:function(){}}}]);